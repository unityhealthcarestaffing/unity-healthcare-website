<script type="module">
  // Your Firebase config (use exactly as provided)
  const firebaseConfig = {
    apiKey: "AIzaSyBe6amsLWa7o-Hp2Zwvn0dpjxfQ9ldbUUU",
    authDomain: "unity-healthcare-staffing.firebaseapp.com",
    projectId: "unity-healthcare-staffing",
    storageBucket: "unity-healthcare-staffing.firebasestorage.app",
    messagingSenderId: "559193698848",
    appId: "1:559193698848:web:8426c72a1749d0c7770245",
    measurementId: "G-J5L3RT870C"
  };

  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
  import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore.js";

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // -------------------------------
  // CLIENT ENQUIRY FORM
  // -------------------------------

  const clientForm = document.getElementById("clientForm");
  const clientFormMessage = document.getElementById("clientFormMessage");

  if (clientForm) {
    clientForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      clientFormMessage.textContent = "";
      clientFormMessage.className = "form-message";

      const formData = new FormData(clientForm);

      const payload = {
        who: formData.get("type"),
        name: formData.get("name"),
        email: formData.get("email"),
        phone: formData.get("phone"),
        serviceName: formData.get("serviceName"),
        message: formData.get("message"),
        createdAt: serverTimestamp()
      };

      try {
        await addDoc(collection(db, "enquiries"), payload);
        clientForm.reset();
        clientFormMessage.textContent =
          "Thank you – your enquiry has been received. We will contact you shortly.";
        clientFormMessage.classList.add("success");
      } catch (error) {
        console.error("Error saving enquiry:", error);
        clientFormMessage.textContent =
          "Sorry, something went wrong. Please try again or email us directly.";
        clientFormMessage.classList.add("error");
      }
    });
  }

  // -------------------------------
  // STAFF REGISTRATION FORM
  // -------------------------------

  const staffForm = document.getElementById("staffForm");
  const staffFormMessage = document.getElementById("staffFormMessage");

  if (staffForm) {
    staffForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      staffFormMessage.textContent = "";
      staffFormMessage.className = "form-message";

      const formData = new FormData(staffForm);

      const payload = {
        name: formData.get("name"),
        email: formData.get("email"),
        phone: formData.get("phone"),
        role: formData.get("role"),
        experienceYears: formData.get("experienceYears"),
        settings: formData.get("settings"),
        dbsStatus: formData.get("dbsStatus"),
        availability: formData.get("availability"),
        createdAt: serverTimestamp()
      };

      try {
        await addDoc(collection(db, "staffApplications"), payload);
        staffForm.reset();
        staffFormMessage.textContent =
          "Thank you – your registration has been received. We will contact you if your profile matches our current opportunities.";
        staffFormMessage.classList.add("success");
      } catch (error) {
        console.error("Error saving staff application:", error);
        staffFormMessage.textContent =
          "Sorry, something went wrong. Please try again or email us directly.";
        staffFormMessage.classList.add("error");
      }
    });
  }

  // Footer year update
  document.getElementById("year").textContent = new Date().getFullYear();
</script>
